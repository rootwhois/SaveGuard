# SaveGuard 用户手册

## 目录
- [快速入门](#快速入门)
- [界面介绍](#界面介绍)
- [功能详解](#功能详解)
- [设置配置](#设置配置)
- [常见问题](#常见问题)
- [故障排除](#故障排除)

## 快速入门

### 首次使用

1. **启动程序**
   - 双击 `SaveGuard-Windows-x64.exe`（根据您的系统选择对应版本）
   - 程序将显示一个半透明的浮窗

2. **选择监控程序**
   - 右键点击浮窗或系统托盘图标
   - 选择"选择应用程序"
   - 在弹出的对话框中选择要监控的程序
   - 点击"确定"

3. **开始监控**
   - 程序将自动开始监控选定的应用程序
   - 当程序运行超过设定时间时，会显示提醒气泡

### 基本操作

- **移动浮窗**: 拖拽浮窗到任意位置
- **右键菜单**: 右键点击浮窗或托盘图标访问所有功能
- **系统托盘**: 程序最小化后会在系统托盘显示图标

## 界面介绍

### 主浮窗
- **标题**: 显示"SaveGuard"
- **状态**: 显示当前监控状态
- **程序计数**: 显示"程序: 运行数/总数"

### 系统托盘
- **图标**: 计算机图标，表示程序正在运行
- **右键菜单**: 包含所有主要功能

### 气泡提示
- **标题**: "SaveGuard 提醒"
- **消息**: 具体的提醒内容
- **按钮**: "一键保存"按钮（可选）

## 功能详解

### 1. 程序监控

#### 自动检测
- 程序启动时自动检测已运行的目标程序
- 实时监控程序启动和关闭状态
- 支持模糊匹配程序名称

#### 手动选择
- 从预置列表中选择常见程序
- 支持添加自定义程序名称
- 实时显示程序运行状态

### 2. 定时提醒

#### 提醒间隔
- 默认5分钟（300秒）
- 可设置范围：10秒 - 60分钟
- 建议设置：代码编辑5分钟，文档编辑10分钟

#### 提醒消息
- **默认消息**: "请记得保存您的劳动成果！"
- **代码编辑器**: "代码已修改，记得保存！"
- **办公软件**: "文档已编辑，请及时保存！"
- **设计工具**: "设计文件已修改，记得保存！"

### 3. 自动保存

#### 聚焦时自动保存
- 当用户回到目标程序时自动执行Ctrl+S
- 需要程序支持Ctrl+S快捷键
- 可随时开启或关闭

#### 一键保存
- 气泡提示中的"立即保存"按钮
- 自动切换到目标程序并执行保存
- 适用于所有支持Ctrl+S的程序

### 4. 整点提醒

#### 功能说明
- 每小时整点自动提醒保存
- 帮助建立良好的保存习惯
- 可独立开启或关闭

#### 使用建议
- 适合长时间工作场景
- 配合定时提醒使用效果更佳

### 5. 提醒历史

#### 记录内容
- 提醒时间
- 目标程序
- 提醒类型
- 操作结果

#### 查看方式
- 右键菜单 → "提醒历史"
- 最多保存100条记录
- 支持清空历史记录

## 设置配置

### 基本设置

#### 语言设置
- 支持中文、英文、日文、韩文
- 切换后立即生效
- 设置会自动保存

#### 提醒间隔
- 设置程序运行多长时间后提醒
- 建议根据工作类型调整
- 代码编辑：5分钟
- 文档编辑：10分钟
- 设计工作：15分钟

#### 气泡显示时长
- 设置提醒气泡显示多长时间
- 范围：1-10秒
- 建议：3-5秒

#### 声音提醒
- 开启/关闭声音提醒
- 使用系统默认提示音
- 支持自定义声音文件

### 高级功能

#### 聚焦时自动保存
- **功能**: 用户回到程序时自动执行保存
- **适用**: 支持Ctrl+S的程序
- **注意**: 需要管理员权限

#### 整点提醒
- **功能**: 每小时整点提醒保存
- **时间**: 1:00, 2:00, 3:00...（避免午夜提醒）
- **用途**: 建立保存习惯

#### 欢迎消息
- **功能**: 程序启动时显示欢迎消息
- **内容**: 检测到已打开的程序列表
- **时长**: 3-4秒

#### 自动选择应用
- **功能**: 启动时自动选择常见应用程序
- **列表**: 包含代码编辑器、办公软件、设计工具等
- **建议**: 首次使用建议开启

### 消息自定义

#### 默认消息
- 通用提醒消息
- 适用于所有程序类型
- 支持变量替换

#### 程序类型消息
- **代码编辑器**: 针对编程工作优化
- **办公软件**: 针对文档编辑优化
- **设计工具**: 针对设计工作优化

#### 特殊消息
- **欢迎消息**: 程序启动时显示
- **整点提醒**: 整点提醒专用

## 常见问题

### Q: 程序无法启动怎么办？
A: 
1. 检查是否有管理员权限
2. 确认Python环境是否正确安装
3. 查看错误日志信息
4. 尝试以管理员身份运行

### Q: 无法检测到目标程序？
A:
1. 确认程序名称是否正确
2. 检查程序是否正在运行
3. 尝试手动添加程序名称
4. 重启SaveGuard程序

### Q: 自动保存功能不工作？
A:
1. 确认目标程序支持Ctrl+S快捷键
2. 检查是否有管理员权限
3. 确认"聚焦时自动保存"已开启
4. 尝试手动点击"一键保存"按钮

### Q: 声音提醒没有声音？
A:
1. 检查系统音量设置
2. 确认"声音提醒"已开启
3. 检查音频设备是否正常
4. 尝试重启程序

### Q: 程序占用内存过高？
A:
1. 检查监控的程序数量
2. 减少不必要的程序监控
3. 调整提醒间隔设置
4. 重启程序释放内存

## 故障排除

### 问题诊断

#### 1. 检查日志
- 查看控制台输出信息
- 注意错误和警告消息
- 记录问题发生的时间

#### 2. 重启程序
- 完全退出SaveGuard
- 等待几秒钟
- 重新启动程序

#### 3. 重置设置
- 删除配置文件
- 重新配置程序
- 测试基本功能

#### 4. 检查依赖
- 确认Python版本正确
- 检查依赖包是否完整
- 重新安装依赖包

### 常见错误

#### 导入错误
```
ImportError: No module named 'PyQt5'
```
**解决方案**: 安装PyQt5
```bash
pip install PyQt5
```

#### 权限错误
```
PermissionError: [WinError 5] 拒绝访问
```
**解决方案**: 以管理员身份运行

#### 进程访问错误
```
psutil.AccessDenied: 拒绝访问进程
```
**解决方案**: 以管理员身份运行

### 性能优化

#### 1. 减少监控程序数量
- 只监控必要的程序
- 定期清理不需要的程序

#### 2. 调整提醒间隔
- 根据工作习惯调整
- 避免过于频繁的提醒

#### 3. 关闭不必要功能
- 不需要时关闭整点提醒
- 关闭欢迎消息

#### 4. 定期重启
- 长时间运行后重启程序
- 释放内存和资源

### 联系支持

如果遇到无法解决的问题，请：

1. 查看 [GitHub Issues](https://github.com/rootwhois/SaveGuard/issues)
2. 搜索相似问题
3. 创建新的Issue
4. 提供详细的错误信息

---

**注意**: 本手册基于SaveGuard v1.0编写，如有更新请查看最新版本。
