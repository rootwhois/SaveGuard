# SaveGuard 多平台图标配置说明

## 概述

本文档详细说明了 SaveGuard 项目在多平台构建时的图标配置情况，包括各平台所需的图标格式、文件路径和配置方法。

## 图标资源结构

```
assets/
├── icon.ico          # Windows 主图标 (ICO格式)
├── icon.png          # 通用 PNG 图标
├── icon.icns         # macOS 图标 (ICNS格式，需要生成)
└── icons/            # 多尺寸图标目录
    ├── saveguard-16x16.png
    ├── saveguard-24x24.png
    ├── saveguard-32x32.png
    ├── saveguard-48x48.png
    ├── saveguard-64x64.png
    ├── saveguard-128x128.png
    ├── saveguard-256x256.png
    └── saveguard.ico
```

## 平台配置详情

### Windows 平台

**支持的架构**: x64, x86, arm64

**图标格式**: `.ico`

**配置文件**:
- `specs/SaveGuard-Windows-x64.exe.spec`
- `specs/SaveGuard-Windows-x86.exe.spec` 
- `specs/SaveGuard-Windows-arm64.exe.spec`

**图标配置**:
```python
icon='../assets/icon.ico'
```

**备用图标**:
- `assets/icons/saveguard.ico`
- `assets/icon.png`

### macOS 平台

**支持的架构**: x86_64, arm64, universal

**图标格式**: `.icns`

**配置文件**:
- `specs/SaveGuard-macOS-x86_64.spec`
- `specs/SaveGuard-macOS-arm64.spec`
- `specs/SaveGuard-macOS-universal.spec`

**图标配置**:
```python
icon='../assets/icon.icns'
```

**备用图标**:
- `assets/icon.png`
- `assets/icon.ico`

**生成 .icns 文件**:
```bash
python create_icons.py
```

### Linux 平台

**支持的架构**: x86_64, aarch64, armv7l

**图标格式**: `.png`

**配置文件**:
- `specs/SaveGuard-Linux-x86_64.spec`
- `specs/SaveGuard-Linux-aarch64.spec`
- `specs/SaveGuard-Linux-armv7l.spec`

**图标配置**:
```python
icon='../assets/icon.png'
```

**备用图标**:
- `assets/icons/saveguard-256x256.png`
- `assets/icon.ico`

## 构建脚本支持

### build_all.py 图标配置

构建脚本会自动为每个平台选择合适的图标：

```python
def _get_icon_path(self, platform_name: str) -> Optional[str]:
    """获取平台对应的图标路径"""
    icon_paths = {
        "windows": "assets/icon.ico",
        "macos": "assets/icon.icns", 
        "linux": "assets/icon.png"
    }
    
    # 自动回退到备用图标
    fallback_paths = {
        "windows": ["assets/icons/saveguard.ico", "assets/icon.png"],
        "macos": ["assets/icon.png", "assets/icon.ico"],
        "linux": ["assets/icons/saveguard-256x256.png", "assets/icon.ico"]
    }
```

## 图标生成工具

### create_icons.py

自动生成多平台所需的图标文件：

**功能**:
- 为 macOS 生成 `.icns` 文件
- 为 Linux 生成多尺寸 PNG 图标
- 支持从 `assets/icon.png` 自动生成

**使用方法**:
```bash
# 安装依赖
pip install Pillow

# 生成图标
python create_icons.py
```

**生成的文件**:
- `assets/icon.icns` (macOS)
- `assets/icons/saveguard-*.png` (Linux 多尺寸)

## 最佳实践

### 1. 图标文件准备

1. **主图标**: 准备高质量的 `assets/icon.png` (推荐 512x512 或更高)
2. **Windows**: 确保有 `assets/icon.ico` 文件
3. **macOS**: 运行 `create_icons.py` 生成 `.icns` 文件
4. **Linux**: 运行 `create_icons.py` 生成多尺寸 PNG 文件

### 2. 构建流程

1. **准备图标**: 确保所有平台图标文件存在
2. **运行构建**: `python build_all.py`
3. **验证图标**: 检查生成的可执行文件是否包含正确图标

### 3. 图标质量要求

- **分辨率**: 至少 256x256 像素
- **格式**: 支持透明背景的 PNG
- **设计**: 简洁明了，在小尺寸下仍清晰可见
- **一致性**: 所有平台使用相同的设计风格

## 故障排除

### 常见问题

1. **macOS 图标不显示**
   - 确保有 `.icns` 文件
   - 运行 `create_icons.py` 生成

2. **Windows 图标模糊**
   - 使用高质量的 `.ico` 文件
   - 包含多种尺寸 (16, 32, 48, 64, 128, 256)

3. **Linux 图标缺失**
   - 确保有 `.png` 文件
   - 检查文件路径是否正确

### 调试方法

1. **检查图标文件**:
   ```bash
   # 检查文件是否存在
   ls -la assets/icon.*
   ls -la assets/icons/
   ```

2. **验证构建配置**:
   ```bash
   # 查看 spec 文件中的图标配置
   grep -n "icon=" specs/*.spec
   ```

3. **测试构建**:
   ```bash
   # 构建单个平台测试
   python build_all.py --platforms windows --current-only
   ```

## 更新日志

- **v1.0**: 初始图标配置
- **v1.1**: 添加 macOS 和 Linux 平台支持
- **v1.2**: 优化图标路径配置和备用方案
- **v1.3**: 添加自动图标生成工具

## 相关文件

- `build_all.py` - 多平台构建脚本
- `create_icons.py` - 图标生成工具
- `specs/` - 各平台构建配置文件
- `assets/` - 图标资源目录
